<!-- 
-->
<!doctype html>

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<title>formatting js test1</title>

<!-- load javascript dependencies -->
<script src="../lib/esprima.js" type="text/javascript"></script>
<script src="../lib/underscore.js" type="text/javascript"></script>

<script src="../src/jsindentator.js" type="text/javascript"></script>
<script src="../src/styles/style_clean.js" type="text/javascript"></script>
<script src="../src/styles/backboneRequireOOInfoExtractor1.js" type="text/javascript"></script>


<!-- load or define at least one syntax style, in this case we use styles.variable1 
because we can configure almost everithing using a josn object.  -->
<!-- <script src="../src/styles/style_variable1.js" type="text/javascript"></script> -->

<!-- optional load more than one style -->
<!-- <script src="../src/styles/style1.js" type="text/javascript"></script> -->
<!-- <script src="../src/styles/style2.js" type="text/javascript"></script> -->
<!-- <script src="../src/styles/style_clean.js" type="text/javascript"></script> -->

<script src="jquery/jquery-2.0.3.min.js" type="text/javascript"></script>
<script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

<style type="text/css">
body {
	font-size: 13px;
}

textarea {
	width: 99%;
	height: 220px;
	-moz-tab-size: 4;
	-o-tab-size: 4;
	-webkit-tab-size: 4;
	tab-size: 4;
	font-family: monospace;
	font-size: 12px;
}

.textbox {
	display: inline;
	width: 40%
}

h4 { */
	display: block;
	font-size: 1.1em;
	margin: 0;
	padding: 0;
}

.outputcode {
	height: 500px;
}
</style>

</head>

<body>


<p>
In this example, we use js-indentator for analize some javascript code that uses a framework 
for defining the class hierarchy with a method called 'extend'. In particular I'm talking about backbone, but the same can be made for other frameworks.  

</p>
	<div class="container">

		<div class="row">

			<div class="span2">
				<button id="doitButton" class="btn-large">do it!</button>
			</div>
			<div class="span10">
				<h3>JavaScript Indentator</h3>
				<p>Demo from project <a href="https://github.com/cancerberoSgx/js-indentator">js-indentator</a></p>
			</div>
		</div>


		<p>Please paste your JavaScript code in the first text area and
			press "do it". The indenter will produce some different styles of
			indentation versions of your code</p>

			<h3>Sample Information extractor</h3>
			<p>In this example we define a very simple jsindentator that in reality is an information extractor. 
				For a very particular kind of javascript modules, defined in vendor technologies like requirejs-underscore-backbone libraries like in the example below, we extract the Object Orriented information from all the given sources like class inheritcance, attributes, methods, etc.</p>


		<div class="row">
			<div class="span7">

				<div class="textbox">
					<h4>Original Code</h4>
<textarea id="input">
// in this example we define a very simple information extractor
define('Tree', ['Leaf', 'Branch', 'Root', 'Apple', 'Object'], function (Leaf, Branch, Root, Apple, Object)
{
	return Object.extend({ 

		//attributes
		template: 'tree'
	,	water: 1
	,	leaves: []

		//methods
	,	addSomeWater: function(){
			this.water++;
		}
	});
});
				


</textarea>
				</div>
			</div>

		<!-- <ul class="nav nav-tabs" id="myTab"> -->
<!-- 			<li class="active"><a href="#home">Style 2</a></li> -->
<!-- 			<li><a href="#minify">Minification</a></li> -->
<!-- 			<li><a href="#style1">Style 1</a></li> -->
<!-- 			<li><a href="#variableStyle1">Variable Style 1</a></li> -->
			
<!-- 			<li><a href="#jsdocgenerator1">Variable Style 1</a></li> -->
		<!-- </ul> -->

		<div class="tab-content">

			<div class="tab-pane active" id="home">
				<h4>Nice Style 2</h4>
				<textarea id="output3" class="outputcode"></textarea>
			</div>

<!-- 			<div class="tab-pane" id="minify"> -->
<!-- 				<h4>Clean Style - Minification</h4> -->
<!-- 				<textarea id="output2" class="outputcode"></textarea> -->
<!-- 			</div> -->

<!-- 			<div class="tab-pane" id="style1"> -->
<!-- 				<h4>Nice Style 1</h4> -->
<!-- 				<textarea id="output1" class="outputcode"></textarea> -->
<!-- 			</div> -->
<!-- 			<div class="tab-pane" id="variableStyle1"> -->
<!-- 				<h4>Nice Style 1</h4> -->
<!-- 				<textarea id="variableStyle1Output1" class="outputcode"></textarea> -->
<!-- 			</div> -->
			
<!-- 			<div class="tab-pane" id="jsdocgenerator1"> -->
<!-- 				<h4>jsdocgenerator1</h4> -->
<!-- 				<textarea id="jsdocgenerator1Output1" class="outputcode"></textarea> -->
<!-- 			</div> -->
			
			
		</div>

	</div>
	
	
<!-- 	first our jsindentator extension for extracting OO information -->


<script type="text/javascript">
// //this extractor will extract information about class inheritance of backbonejs&requirejs based code.
// (function() {

// var ns = jsindentator; 
// if(!ns.styles) ns.styles={}; 

// var extractor1 = ns.styles.backboneRequireOOInfoExtraction = {};
// _.extend(extractor1, ns.styles.clean);//we extends from a base that support all the language so we do a full ast iteration. 
// _.extend(extractor1, {		
// 	installStyle: function() {
// 		this.data1=[];
// 	}
// ,	postRender: function(){	
// 		return this.data1;
// 	}
// ,	"Identifier": function(node, config) {
	
// // 		var parentClass = null, thisClass=null;  
		
// 		if(node.name==='define'&& node.parentNode && node.parentNode.type==="CallExpression" && 
// 				node.parentNode.arguments.length>2) {
// // 			thisClass=node.parentNode.arguments[0].value; 
// 			this.currentDefineClass=node.parentNode.arguments[0].value; 
// // 			this.data1.push("1 thisClass found: "+thisClass); 
// 		}
// 		//TODO. else if node.name==='define' log it some way
// 		else if(node.name==='extend' && node.parentNode.type==="MemberExpression") {
// 			var parentClass = node.parentNode.object.name;
			
// 			this.data1.push(this.currentDefineClass+" extends "+parentClass); 
// 		}
// 		//TODO. else if node.name==='extend' log it some way
// 	}
// }); 
// })();
</script>



<!-- now the GUI code of this page -->
	<script>
		function escapeHTML(html) {
			html = html.replace(/[<>]/g, function(match) {
				if (match === '<')
					return '&lt;';
				else
					return '&gt;';
			});
			return html;
		}; 
		var doit = function(e) {
						
			var config = {};
			
// 			if(jQuery("#applyConfigCheckbox").val()) {
			// try {
			// 	config = eval('(' + $('#config').val() + ')');
			// } catch (ex) {
			// 	alert('config.parse error, using default. error: ' + ex);
			// 	config = {};
			// }
// 			}

			if (!config) {
				alert('config parse error, using default. ');
				config = {};
			}

			var code = jQuery('#input').val() || jQuery('#input').html();
			var indentedCode = "";

// 			jsindentator.setStyle(jsindentator.styles.style1);
// 			indentedCode = escapeHTML(jsindentator.main(code, config));
// 			jQuery('#output1').html(indentedCode);

// 			jsindentator.setStyle(jsindentator.styles.clean);
// 			indentedCode = escapeHTML(jsindentator.main(code, config));
// 			jQuery('#output2').html(indentedCode);

			jsindentator.setStyle(jsindentator.styles.backboneRequireOOInfoExtraction);
			indentedCode = escapeHTML(jsindentator.main(code, config));
			if(indentedCode instanceof Error) {
				alert('ERROR: The passed javascript coulnd\'t be parsed!, reason: '+result); 
				return;
			}
			jQuery('#output3').html(indentedCode+" HELLLLLOOOOO");

// 			jsindentator.setStyle(jsindentator.styles.variable1);
// 			indentedCode = escapeHTML(jsindentator.main(code, config));
// 			jQuery('#variableStyle1Output1').html(indentedCode);
			
// 			jsindentator.setStyle(jsindentator.styles.jsdocgenerator1);
// 			indentedCode = escapeHTML(jsindentator.main(code, config));
// 			jQuery('#jsdocgenerator1Output1').html(indentedCode);
			
			
			

		};
		jQuery('#doitButton').click(doit);
		doit();
		$('#myTab a').click(function(e) {
			e.preventDefault();
			$(this).tab('show');
		});
		$('#myTab a:last').tab('show');
		
		$(document).ready(function(){
	        $(".collapse").collapse()
		});
		
		// //textarea auto focus - http://stackoverflow.com/questions/5797539/jquery-select-all-text-from-a-textarea
		// var selectAll= function() {
		//     var $this = $(this);
		//     $this.select();

		//     // Work around Chrome's little problem
		//     $this.mouseup(function() {
		//         // Prevent further mouseup intervention
		//         $this.unbind("mouseup");
		//         return false;
		//     });
		// }; 
		// $("textarea").focus(selectAll);
		// $("textarea").click(selectAll);

		// 
	</script>

</body>

</html>
